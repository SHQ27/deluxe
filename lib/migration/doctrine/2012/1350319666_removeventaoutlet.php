<?php
/**
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class Removeventaoutlet extends Doctrine_Migration_Base
{
    public function up()
    {
        $q = Doctrine_Manager::getInstance()->getCurrentConnection();
        
        $q->execute("SELECT * FROM venta_outlet;");
        $ventasOutlet = $q->fetchAll("SELECT * FROM venta_outlet;");
        foreach ($ventasOutlet as $ventaOutlet)
        {            
            $pedidoProductoItem = pedidoProductoItemTable::getInstance()->getByCompoundKey($ventaOutlet['id_pedido'], $ventaOutlet['id_producto_item']);
            $pedidoProductoItem->setVentaOutlet( $ventaOutlet['cantidad'] );
            $pedidoProductoItem->save();
        }
        
        $q->execute("UPDATE pedido_producto_item SET venta_outlet = 0 WHERE venta_outlet IS NULL;");
        
    }

    public function down()
    {

    }
}