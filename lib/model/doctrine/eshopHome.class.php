<?php

/**
 * eshopHome
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 * 
 * @package    deluxebuys
 * @subpackage model
 * @author     Your name here
 * @version    SVN: $Id: Builder.php 7490 2010-03-29 19:53:27Z jwage $
 */
class eshopHome extends BaseeshopHome
{
    CONST TIPO_BANNER_PRINCIPAL_FULLSCREEN  = 'BPRFS';
    CONST TIPO_BANNER_PRINCIPAL_NORMAL      = 'BPRNO';
    CONST TIPO_BANNER_SECUNDARIO_X_2_1      = 'BSX21';
    CONST TIPO_BANNER_SECUNDARIO_X_2_2      = 'BSX22';
    CONST TIPO_BANNER_SECUNDARIO_X_2_3      = 'BSX23';
    CONST TIPO_BANNER_SECUNDARIO_X_3        = 'BSEX3';
    CONST TIPO_BANNER_CINTA_1 				= 'BCINT';
    CONST TIPO_TEXTO 						= 'TEXTO';
    CONST TIPO_GRILLA_1                     = 'GRLA1';
    CONST TIPO_GRILLA_2                     = 'GRLA2';
    CONST TIPO_GRILLA_3                     = 'GRLA3';
    CONST TIPO_GRILLA_4                     = 'GRLA4';
    CONST TIPO_PRODUCTOS_DESTACDOS 			= 'PRODE';

    public static $TIPOS = array(
        self::TIPO_BANNER_PRINCIPAL_FULLSCREEN  => 'Banner Principal - Full Screen',
        self::TIPO_BANNER_PRINCIPAL_NORMAL      => 'Banner Principal - Normal',
        self::TIPO_BANNER_SECUNDARIO_X_2_1      => 'Banner Secundario x 2 - (1/2 + 1/2)',
        self::TIPO_BANNER_SECUNDARIO_X_2_2      => 'Banner Secundario x 2 - (2/3 + 1/3)',
        self::TIPO_BANNER_SECUNDARIO_X_2_3      => 'Banner Secundario x 2 - (1/3 + 2/3)',
        self::TIPO_BANNER_SECUNDARIO_X_3        => 'Banner Secundario x 3',
        self::TIPO_BANNER_CINTA_1               => 'Banner tipo cinta 1',
        self::TIPO_TEXTO                        => 'Texto',
        self::TIPO_GRILLA_1                     => 'Grilla Nº 1',
        self::TIPO_GRILLA_2                     => 'Grilla Nº 2',
        self::TIPO_GRILLA_3                     => 'Grilla Nº 3',
        self::TIPO_GRILLA_4                     => 'Grilla Nº 4',
        self::TIPO_PRODUCTOS_DESTACDOS          => 'Productos destacados'
    );

    public static $GRILLA = array(
        '1'  => array('1H3V','1H3V','1H3V','1H3V','1H3V','1H3V'),
        '2'  => array('1H2V','1H4V','1H2V','1H4V','1H2V','1H4V'),
        '3'  => array('1H2V','1H4V','1H2V','1H2V','2H2V','1H4V'),
        '4'  => array('1H4V','1H4V','1H2V','1H2V','1H2V','1H4V'),
    );

    public static $BANNERS_SECUNDARIOS = array(
        '1'  => array('3H1V','3H1V'),
        '2'  => array('4H1V','2H1V'),
        '3'  => array('2H1V','4H1V'),
    );

    public function preSave($event)
    {
        $this->clearCache($event);
    }
    
    public function preDelete($event)
    {
        $eshopHomeMultimedias = $this->getEshopHomeMultimedia();
        foreach ($eshopHomeMultimedias as $eshopHomeMultimedia) {
            $eshopHomeMultimedia->delete();
        }

        $this->clearCache($event);
    }
    
    public function clearCache($event)
    {
        cacheHelper::getInstance()->delete('eshopHome_listHome_' . $this->getIdEshop() );
    }
    
    public function canOrderDown()
    {
        $first = eshopHomeTable::getInstance()->getFirst( $this->getIdEshop() );
    
        if ( $first )
        {
            return $first->getIdEshopHome() != $this->getIdEshopHome();
        }
    }
    
    public function canOrderUp()
    {
        $last = eshopHomeTable::getInstance()->getLast( $this->getIdEshop() );
    
        if ( $last )
        {
            return $last->getIdEshopHome() != $this->getIdEshopHome();
        }
    }

    public function getTipoDenominacion() {
        return self::$TIPOS[ $this->getTipo() ];
    }

}