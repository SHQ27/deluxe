<?php

/**
 * promoPago
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 * 
 * @package    deluxebuys
 * @subpackage model
 * @author     Your name here
 * @version    SVN: $Id: Builder.php 7490 2010-03-29 19:53:27Z jwage $
 */
class promoPago extends BasepromoPago
{
	public function getImageFilename()
	{
		return $this->getIdPromoPago() . '.jpg';		
	}

    public function canOrderDown()
    {

        $first = promoPagoTable::getInstance()->getFirst();
    
        if ( $first )
        {
            return $first->getIdPromoPago() != $this->getIdPromoPago();
        }
    }
    
    public function canOrderUp()
    {
        $last = promoPagoTable::getInstance()->getLast();
    
        if ( $last )
        {
            return $last->getIdPromoPago() != $this->getIdPromoPago();
        }
    }

    public function esValida( $idEshop, $cuotas )
    {
        // Si no esta activo
        if ( !$this->getActivo() ) return false;

        // Si no corresponde al eshop
        if ( $this->getIdEshop() != $idEshop ) return false;


        // Si no corresponde al eshop
        if ( strtotime( $this->getVigenciaDesde() ) > time() ) return false;
        if ( strtotime( $this->getVigenciaHasta() ) < time() ) return false;

        // Si se eligiÃ³ una cuota existente
        if ( stripos( $this->getCuotas(), $cuotas ) === false ) return false;

        // Si se eligiÃ³ una cuota existente
        $dow = date('w') + 1;
        $dow = (string) $dow;
        
        if ( $this->getDiasSemana() != null && stripos( $this->getDiasSemana(), $dow ) === false ) return false;
        return true;
    }

}
